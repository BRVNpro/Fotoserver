<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–ö–∞—Ç–∞–ª–æ–≥ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π</title>

  <link href="https://fonts.googleapis.com/css2?family=Kurale&family=Marck+Script&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <style>
    :root {
      --color-bg: #000000;
      --color-text: #cccccc;
      --color-accent: #0a93c0;
    }

    body {
      background-color: var(--color-bg);
      color: var(--color-text);
      font-family: 'Kurale', serif;
    }

    h2 {
      font-size: 2rem;
      font-weight: normal;
      letter-spacing: 1px;
    }

    .subtitle {
      font-size: 1.2rem;
      opacity: 0.8;
    }

    .nav-link-custom {
      font-weight: 600;
      margin: 0 10px;
      text-decoration: none;
      color: var(--color-text);
      transition: color 0.2s ease;
    }

    .nav-link-custom:hover,
    .nav-link-custom.active {
      color: var(--color-accent) !important;
    }

    .table {
      background-color: #111;
      color: var(--color-text);
    }

    .table-light {
      background-color: #222 !important;
    }

    .btn-danger {
      font-family: 'Kurale', serif;
    }

    img.preview {
      max-height: 80px;
      border-radius: 4px;
      transition: transform 0.2s ease;
    }

    img.preview:hover {
      transform: scale(1.2);
    }

    .btn-primary {
      background-color: var(--color-bg) !important;
      color: var(--color-accent);
      border: 2px solid var(--color-accent);
      padding: 5px 10px;
      border-radius: 6px;
      font-size: 0.9rem;
      font-family: 'Kurale', serif;
      text-shadow: 0 0 1px var(--color-accent);
      box-shadow: 0 0 6px rgba(10, 147, 192, 0.3);
      cursor: pointer;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      appearance: none;
    }

    .btn-primary:hover {
      transform: scale(1.06);
      box-shadow: 0 0 10px rgba(10, 147, 192, 0.6), 0 0 20px rgba(10, 147, 192, 0.4);
    }

    .fixed-home {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
    }

    .btn-home {
      background-color: var(--color-bg);
      color: var(--color-accent);
      border: 2px solid var(--color-accent);
      padding: 10px 20px;
      border-radius: 10px;
      font-family: 'Kurale', serif;
      text-shadow: 0 0 1px var(--color-accent);
      box-shadow: 0 0 6px rgba(10, 147, 192, 0.3);
      cursor: pointer;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .btn-home:hover {
      transform: scale(1.06);
      box-shadow: 0 0 10px rgba(10, 147, 192, 0.6), 0 0 20px rgba(10, 147, 192, 0.4);
    }
  </style>
</head>
<body>
  <div class="container py-5 text-center">
    <h2>–ù–∞–π–¥–∏ –∑–¥–µ—Å—å</h2>
    <p class="subtitle">—Ç–æ, —á—Ç–æ —Ö–æ—á–µ—à—å –≤—Å–ø–æ–º–Ω–∏—Ç—å... –∏–ª–∏ —É–¥–∞–ª–∏—Ç—å</p>

    <div class="mb-4">
      <a href="/upload" class="nav-link-custom">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</a>
      <a href="/images" class="nav-link-custom active">–ù–∞–π—Ç–∏</a>
    </div>

    <div class="container mt-4">
      <table class="table table-striped text-center mt-3">
        <thead class="table-light">
          <tr>
            <th><input type="checkbox" id="selectAll" onclick="toggleSelectAll(this)"></th>
            <th>–ü—Ä–µ–≤—å—é</th>
            <th>–ò–º—è —Ñ–∞–π–ª–∞</th>
            <th>–°–∫–∞—á–∞—Ç—å</th>
            <th>–£–¥–∞–ª–∏—Ç—å</th>
          </tr>
        </thead>
        <tbody>
          {% for image in images %}
          <tr>
            <td><input type="checkbox" class="image-checkbox" value="{{ image.name }}"></td>
            <td>
              <a href="{{ image.url }}" target="_blank">
                <img src="{{ image.url }}" alt="{{ image.name }}" class="preview">
              </a>
            </td>
            <td>{{ image.name }}</td>
            <td>
              <a href="{{ image.url }}" download class="btn-primary">‚¨áÔ∏è</a>
            </td>
            <td>
              <button class="btn btn-sm btn-danger" onclick="deleteImage('{{ image.name }}')">üóëÔ∏è</button>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>

      <button class="btn-primary mt-2" onclick="deleteSelected()">–£–¥–∞–ª–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–µ</button>

      <div class="mt-3">
        {% if page > 1 %}
          <a href="/images?page={{ page - 1 }}" class="btn-primary">‚¨Ö –ü—Ä–µ–¥—ã–¥—É—â–∞—è</a>
        {% endif %}
        {% if has_next %}
          <a href="/images?page={{ page + 1 }}" class="btn-primary">–°–ª–µ–¥—É—é—â–∞—è ‚û°</a>
        {% endif %}
      </div>
    </div>

    <div class="fixed-home">
      <a href="/" class="btn-home">–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É</a>
    </div>
  </div>

  <script>
    function toggleSelectAll(master) {
      const checkboxes = document.querySelectorAll('.image-checkbox');
      checkboxes.forEach(cb => cb.checked = master.checked);
    }

    async function deleteSelected() {
      const selected = Array.from(document.querySelectorAll('.image-checkbox'))
                            .filter(cb => cb.checked)
                            .map(cb => cb.value);
      if (selected.length === 0) {
        alert("–í—ã–±–µ—Ä–∏—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω —Ñ–∞–π–ª –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è.");
        return;
      }

      if (!confirm(`–£–¥–∞–ª–∏—Ç—å ${selected.length} —Ñ–∞–π–ª(–æ–≤)?`)) return;

      for (let filename of selected) {
        await fetch(`/delete/${filename}`, { method: 'POST' });
      }

      location.reload();
    }

    async function deleteImage(filename) {
      if (!confirm(`–£–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª: ${filename}?`)) return;

      const response = await fetch(`/delete/${filename}`, { method: 'POST' });
      if (response.ok) {
        location.reload();
      } else {
        const data = await response.json();
        alert("–û—à–∏–±–∫–∞: " + data.detail);
      }
    }
  </script>
</body>
</html>
